---
title: নিরাপত্তা (Security)
parent: Chapters
nav_order: 6
---

# ৬: নিরাপত্তা (Security)


আপনি একটি অসাধারণ প্লাগিন তৈরি করেছেন যার অনেক ফিচার আছে, চমৎকার ইউজার ইন্টারফেস এবং এটি খুব দ্রুত কাজ করে। কিন্তু যদি প্লাগিনটি নিরাপদ না হয়, তাহলে আপনার সমস্ত পরিশ্রম বৃথা যেতে পারে। একটি সামান্য দুর্বলতা বা ভুল আপনার ব্যবহারকারীর পুরো ওয়েবসাইটকে হ্যাকারদের হাতে তুলে দিতে পারে।

নিরাপত্তা কোনো অতিরিক্ত ফিচার নয়; এটি প্লাগিন ডেভেলপমেন্ট প্রক্রিয়ার একটি অবিচ্ছেদ্য এবং মৌলিক অংশ। একজন পেশাদার ডেভেলপার হিসেবে, আপনার দায়িত্ব হলো ব্যবহারকারীর ডেটা এবং ওয়েবসাইটকে সুরক্ষিত রাখা।

এই অধ্যায়ে আমরা ওয়ার্ডপ্রেস প্লাগিন সুরক্ষিত রাখার জন্য কিছু অপরিহার্য কৌশল এবং সেরা অনুশীলন সম্পর্কে জানব। আমরা শিখব কীভাবে সাধারণ কিন্তু মারাত্মক দুর্বলতা যেমন Cross-Site Scripting (XSS) এবং Cross-Site Request Forgery (CSRF) থেকে আপনার প্লাগিনকে রক্ষা করা যায়।

### **৬.১ ওয়ার্ডপ্রেস নিরাপত্তার তিনটি গোল্ডেন রুল**

ওয়ার্ডপ্রেস প্লাগিন সুরক্ষিত রাখার জন্য তিনটি প্রধান নীতি মনে রাখলেই নিরাপত্তার অর্ধেক কাজ হয়ে যায়:

1.  কখনোই ব্যবহারকারীর ইনপুটকে বিশ্বাস করবেন না (Never Trust User Input): ধরে নিন, ব্যবহারকারীর কাছ থেকে আসা যেকোনো ডেটা (ফর্ম ইনপুট, URL প্যারামিটার) ক্ষতিকর হতে পারে। ডেটাবেসে সেভ করার আগে বা অন্য কোনো কাজে ব্যবহার করার আগে অবশ্যই তা পরিষ্কার (sanitise) এবং যাচাই (validate) করুন।

2.  সর্বদা আউটপুট এস্কেপ করুন (Always Escape Output): ডেটাবেস বা অন্য কোনো সোর্স থেকে আসা ডেটা যখনই স্ক্রিনে (HTML, CSS, JavaScript) প্রদর্শন করবেন, তখন তা অবশ্যই এস্কেপ (escape) করুন। এটি Cross-Site Scripting (XSS) অ্যাটাক প্রতিরোধ করে।

3.  সর্বদা অনুমতি যাচাই করুন (Always Check Permissions): কোনো সংবেদনশীল কাজ (যেমন: ডেটা ডিলিট করা, সেটিংস পরিবর্তন করা) করার আগে সর্বদা যাচাই করুন যে বর্তমান ব্যবহারকারীর সেই কাজটি করার অনুমতি বা সক্ষমতা (capability) আছে কি না।


### **৬.২ Nonces: নকল অনুরোধ প্রতিরোধ করা**

Nonce (Number used once) হলো একটি অনন্য, স্বল্পস্থায়ী কোড যা ওয়ার্ডপ্রেস তৈরি করে কোনো অনুরোধ বা অ্যাকশনের সত্যতা যাচাই করার জন্য। এর প্রধান কাজ হলো CSRF (Cross-Site Request Forgery) অ্যাটাক প্রতিরোধ করা।

CSRF অ্যাটাক কী?

সহজ ভাষায়, এটি এমন একটি অ্যাটাক যেখানে হ্যাকার একজন লগইন করা ব্যবহারকারীকে অজান্তেই কোনো ক্ষতিকর কাজ করতে বাধ্য করে। যেমন, একজন অ্যাডমিন অন্য কোনো ওয়েবসাইটে ব্রাউজ করার সময় হ্যাকার তাকে দিয়ে আপনার প্লাগিনের কোনো ডেটা ডিলিট করার একটি নকল অনুরোধ পাঠাতে পারে।

Nonce যেভাবে কাজ করে:

আপনি যখন কোনো ফর্ম বা URL তৈরি করবেন, তখন ওয়ার্ডপ্রেসকে একটি Nonce তৈরি করতে বলবেন। যখন ব্যবহারকারী ফর্মটি সাবমিট করবে, তখন ওয়ার্ডপ্রেস চেক করবে যে অনুরোধের সাথে পাঠানো Nonce টি বৈধ কি না। যদি না হয়, তাহলে অনুরোধটি বাতিল করে দেবে।

উদাহরণ: একটি ডিলিট লিঙ্কে Nonce ব্যবহার

```php
// ধাপ ১: ডিলিট লিঙ্কে Nonce যোগ করা
$log_id = 123;
$delete_nonce = wp_create_nonce('aem_delete_log_' . $log_id);
$delete_url = admin_url('admin-post.php?action=aem_delete_log&log_id=' . $log_id . '&_wpnonce=' . $delete_nonce);

echo '<a href="' . esc_url($delete_url) . '">Delete Log</a>';

// ধাপ ২: অনুরোধটি প্রসেস করার আগে Nonce যাচাই করা
add_action('admin_post_aem_delete_log', function () {
    // অনুমতি যাচাই করা
    if (!current_user_can('manage_options')) {
        wp_die('You do not have permission to do this.');
    }

    // Nonce যাচাই করা
    if (!isset($_GET['_wpnonce']) || !wp_verify_nonce($_GET['_wpnonce'], 'aem_delete_log_' . $_GET['log_id'])) {
        wp_die('Security check failed!');
    }

    // এখন ডেটা ডিলিট করা নিরাপদ
    $log_id_to_delete = absint($_GET['log_id']);
    // ... ডিলিট করার কোড ...
});
```

### **৬.৩ ডেটা স্যানিটাইজেশন ও ভ্যালিডেশন (ইনপুট ফিল্টারিং)**

ব্যবহারকারীর কাছ থেকে আসা যেকোনো ডেটা ব্যবহার করার আগে তা পরিষ্কার করাকে স্যানিটাইজেশন বলে। ওয়ার্ডপ্রেসে এর জন্য অনেক বিল্ট-ইন ফাংশন রয়েছে।

কিছু গুরুত্বপূর্ণ স্যানিটাইজেশন ফাংশন:

*   sanitize\_text\_field($input): সাধারণ টেক্সট ফিল্ডের জন্য। অপ্রয়োজনীয় ট্যাগ ও স্পেস দূর করে।

*   sanitize\_email($email): একটি ইমেইল অ্যাড্রেস থেকে অবৈধ অক্ষর দূর করে।

*   sanitize\_key($key): ইউজারনেম বা মেটা কী-এর মতো ভ্যালুর জন্য ব্যবহৃত হয়।

*   absint($number): একটি সংখ্যাকে অ্যাবসোলিউট (ধনাত্মক) পূর্ণসংখ্যায় রূপান্তরিত করে।

*   esc\_url\_raw($url): ডেটাবেসে সেভ করার জন্য একটি URL-কে পরিষ্কার করে।


উদাহরণ: ফর্ম সাবমিশন হ্যান্ডেল করা

```php
function process_event_submission() {
    if (isset($_POST['submit_event'])) {
        // Nonce চেক করার পর...

        $event_title = sanitize_text_field($_POST['event_title']);
        $event_email = sanitize_email($_POST['event_email']);
        $max_attendees = absint($_POST['max_attendees']);

        // এখন এই স্যানিটাইজ করা ডেটাগুলো ডেটাবেসে সেভ করা নিরাপদ
        // ...
    }
}
```
### **৬.৪ আউটপুট এস্কেপিং (ডিসপ্লে সুরক্ষিত করা)**

ডেটাবেস থেকে পাওয়া ডেটা যখন ব্রাউজারে দেখানো হয়, তখন তা অবশ্যই এস্কেপ করতে হবে। এটি XSS (Cross-Site Scripting) অ্যাটাক প্রতিরোধ করে। XSS অ্যাটাকে হ্যাকার আপনার সাইটে ক্ষতিকর জাভাস্ক্রিপ্ট কোড প্রবেশ করায়, যা অন্য ব্যবহারকারীদের ব্রাউজারে রান করে তাদের তথ্য চুরি করতে পারে।

কিছু গুরুত্বপূর্ণ এস্কেপিং ফাংশন:

*   esc\_html($text): সাধারণ টেক্সট প্রদর্শনের জন্য। এটি < > & " ' অক্ষরগুলোকে HTML এনটিটিতে রূপান্তর করে।

*   esc\_attr($attribute): HTML ট্যাগের অ্যাট্রিবিউটের ভেতর ভ্যালু দেখানোর জন্য (যেমন: value="", class="")।

*   esc\_url($url): HTML লিঙ্কের href বা ইমেজের src অ্যাট্রিবিউটে URL দেখানোর জন্য।

*   esc\_js($script): জাভাস্ক্রিপ্ট কোডের ভেতর কোনো টেক্সট বা ভ্যারিয়েবল প্রিন্ট করার জন্য।


উদাহরণ: ভুল বনাম সঠিক পদ্ধতি

```php
$user_comment = get_option('user_feedback_comment');

// ভুল পদ্ধতি (XSS এর জন্য ঝুঁকিপূর্ণ)
echo '<p>' . $user_comment . '</p>';
echo '<input type="text" value="' . $user_comment . '">';

// সঠিক ও নিরাপদ পদ্ধতি
echo '<p>' . esc_html($user_comment) . '</p>';
echo '<input type="text" value="' . esc_attr($user_comment) . '">';
```

### সারসংক্ষেপ

এই অধ্যায়ে আমরা প্লাগিন নিরাপত্তার মৌলিক স্তম্ভগুলো সম্পর্কে জেনেছি। একটি সুরক্ষিত প্লাগিন তৈরি করা কঠিন নয়, যদি শুরু থেকেই সঠিক অভ্যাসগুলো গড়ে তোলা যায়। আমরা শিখেছি:

*   ওয়ার্ডপ্রেস নিরাপত্তার তিনটি গোল্ডেন রুল: ইনপুট ফিল্টার করা, আউটপুট এস্কেপ করা এবং অনুমতি যাচাই করা।

*   Nonces ব্যবহার করে কীভাবে CSRF অ্যাটাক থেকে ফর্ম এবং অ্যাকশন লিঙ্কগুলোকে সুরক্ষিত রাখতে হয়।

*   sanitize\_\* ফাংশনগুলো ব্যবহার করে ব্যবহারকারীর ইনপুটকে নিরাপদ করার গুরুত্ব।

*   esc\_\* ফাংশনগুলো ব্যবহার করে সাইটকে XSS অ্যাটাক থেকে বাঁচানোর উপায়।

*   current\_user\_can() ব্যবহার করে ব্যবহারকারীর অনুমতি যাচাই করার অপরিহার্যতা।


এই নীতিগুলো অনুসরণ করলে আপনার প্লাগিন শুধু কার্যকরীই হবে না, বরং আপনার ব্যবহারকারীদের জন্য একটি নিরাপদ এবং নির্ভরযোগ্য টুল হিসেবেও গণ্য হবে।

পরবর্তী অধ্যায়ে...

এখন যেহেতু আমাদের প্লাগিনটি কার্যকরী, সুসংগঠিত এবং নিরাপদ, এবার এটিকে দ্রুতগামী করার দিকে মনোযোগ দেওয়ার পালা। পরবর্তী অধ্যায়ে আমরা পারফরম্যান্স অপটিমাইজেশন নিয়ে আলোচনা করব এবং শিখব কীভাবে আপনার কোড এবং কোয়েরি অপটিমাইজ করে সাইটের গতি বৃদ্ধি করা যায়।